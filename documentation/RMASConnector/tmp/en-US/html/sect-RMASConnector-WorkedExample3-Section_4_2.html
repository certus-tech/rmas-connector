<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>7.4.2. Aggregate Data</title><link rel="stylesheet" href="Common_Content/css/default.css" type="text/css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 2.1" /><meta name="package" content="RMASConnector-RMASConnector-1.0-en-US-1-0" /><link rel="home" href="index.html" title="RMASConnector" /><link rel="up" href="sect-RMASConnector-WorkedExample3-Section_4.html" title="7.4. Running the job from Spoon" /><link rel="prev" href="sect-RMASConnector-WorkedExample3-Section_4.html" title="7.4. Running the job from Spoon" /><link rel="next" href="ch07s04s03.html" title="7.4.3. A note on scalability" /></head><body class="toc_embeded "><div id="tocdiv" class="toc"><iframe id="tocframe" class="toc" src="../../../../toc.html">This is an iframe, to view it upgrade your browser or enable iframe display.</iframe></div><p id="title"><a class="left" href="http://rmas.certus-tech.com"><img src="Common_Content/images/image_left.png" alt="Product Site" /></a><a class="right" href="http://rmas.certus-tech.com/documentation"><img src="Common_Content/images/image_right.png" alt="Documentation Site" /></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="sect-RMASConnector-WorkedExample3-Section_4.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="ch07s04s03.html"><strong>Next</strong></a></li></ul><div class="section" title="7.4.2. Aggregate Data" id="sect-RMASConnector-WorkedExample3-Section_4_2"><div class="titlepage"><div><div><h3 class="title" id="sect-RMASConnector-WorkedExample3-Section_4_2">7.4.2. Aggregate Data</h3></div></div></div><div class="para">
				The <span class="emphasis"><em>MapAndAggregateData</em></span> transformation uses two streams. The top stream performs a query on the HR database, and then removes fields which are not required, while mapping others to a CERIF-backed Common Data Model (CDM). The rows are then sorted ready for joining:
			</div><div class="figure" title="Figure 7.2. The MapAndAggregateData transformation top stream" id="sect-RMASConnector-WorkedExample3-Section_4_2_figure"><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/WorkedExample3/Example3TopStream.png" align="middle" alt="The MapAndAggregateData transformation top stream" /></div></div><h6>Figure 7.2. The MapAndAggregateData transformation top stream</h6></div><br class="figure-break" /><div class="para">
				As an alternative, the fields removed by the <span class="emphasis"><em>Map To CDM</em></span> step could have been omitted by altering the SQLQuery parameter.
			</div><div class="para">
				The bottom stream extracts data from a Symplectic CSV file. It removes unwanted fields and maps the remainder to the CDM. A lookup step is then performed, where the key for each row in the Symplectic data is looked up in the mapping CSV file, and the corresponding HR key is added to the row:
			</div><div class="figure" title="Figure 7.3. The MapAndAggregateData transformation bottom stream" id="sect-RMASConnector-WorkedExample3-Section_4_3_figure"><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/WorkedExample3/Example3BottomStream.png" align="middle" alt="The MapAndAggregateData transformation bottom stream" /></div></div><h6>Figure 7.3. The MapAndAggregateData transformation bottom stream</h6></div><br class="figure-break" /><div class="para">
				Prior to the join, the data in the stream is again sorted on the HR key. This is necessary in order to correctly perform a merge join on the HR key:
			</div><div class="figure" title="Figure 7.4. The MapAndAggregateData transformation join" id="sect-RMASConnector-WorkedExample3-Section_4_4_figure"><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/WorkedExample3/Example3Join.png" align="middle" alt="The MapAndAggregateData transformation join" /></div></div><h6>Figure 7.4. The MapAndAggregateData transformation join</h6></div><br class="figure-break" /><div class="para">
				The joined data is then saved to a CSV file.
			</div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="sect-RMASConnector-WorkedExample3-Section_4.html"><strong>Prev</strong>7.4. Running the job from Spoon</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="ch07s04s03.html"><strong>Next</strong>7.4.3. A note on scalability</a></li></ul></body></html>
